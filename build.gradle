apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'eclipse'

mainClassName = 'ui.LwrtGUI'

sourceSets {
    main {
        resources {
            exclude '**/*.db'
        }
    }
}

new ByteArrayOutputStream().withStream { execOS ->
    exec {
        executable = 'git'
        args = [ 'describe', '--tags', '--always' ]
        standardOutput = execOS
    }
    def buildVersion = execOS.toString().trim()
    version buildVersion
}

jar {
    archiveName = 'lawena.jar'
    destinationDir = null
    manifest {
        ext.buildTime = new Date().format("yyyyMMddHHmmss")
        file('version.txt').write ext.buildTime
        
        attributes (
            'Main-Class': mainClassName,
            'Implementation-Title': 'lawena Recording Tool',
            'Implementation-Version': version,
            'Implementation-Build': ext.buildTime,
            'SplashScreen-Image': 'ui/splash.png'
        )
    }
}